PULA_LINHA MACRO ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA MACRO ; macro de pular linha (será usado repetidas vezes ao longo do jogo)
  PUSH AX
  MOV AH, 02H
  MOV DL, 10
  INT 21H
  POP AX
ENDM

PUSHALL MACRO 
  PUSH AX
  PUSH BX 
  PUSH CX 
  PUSH DX 
  PUSH SI 
ENDM 
; MACRO DE EMPILHAMENTO QUE SERÁ USADA VÁRIAS VEZES NO DECORRER DO PROGRAMA

POPALL MACRO ; MACRO DE DESEMPILHAMENTO QUE SERÁ USUADA REPETIDAS VEZES DURANTE O PROGRAMA 
  POP AX
  POP BX 
  POP CX 
  POP DX 
  POP SI 
ENDM

; MACRO DE LIMPEZA DE TELA (CLS = Clear Screen), SERÁ USADA REPETIDAS VEZES AO LONGO DO PROGRAMA
; REFERÊNCIA DE USO DA FUNÇÃO: (https://www.gabrielececchetti.it/Teaching/CalcolatoriElettronici/Docs/i8086_and_DOS_interrupts.pdf)
; E (https://stackoverflow.com/questions/8239143/how-can-i-clear-the-screen-without-having-to-fill-it)
CLS MACRO
  PUSH AX ; EMPILHA O VALOR ATUAL DE AX

  MOV AH, 0H ; EXECUÇÃO DE LIMPEZA DE TELA PROPRIAMENTE  
  MOV AL, 03H
  INT 10H 
  
  POP AX ; DESEMPILHA PEGA O VALOR DO TOPO DA PILHA E O ALOCA EM AX
ENDM
  
TEXTO_INICIO MACRO ; MACRO QUE IMPRIME O TEXTO DE BOAS-VINDAS AO USUÁRIO NO MOMENTO DE INÍCIO DO PROGRAMA
  PUSH AX
  PUSH DX
  MOV AH,9
  LEA DX,MSG_BEMVINDO
  INT 21h
  POP DX
  POP AX
ENDM

VEZ_JOG1_IMP MACRO ; MACRO QUE SINALIZA AO PROGRAMA QUE É A VEZ DO JOGADOR 1 JOGAR
  PUSH AX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_VEZ_J1
  INT 21h

  POP DX
  POP AX
ENDM

VEZ_JOG2_COMP_IMP MACRO ; MACRO QUE SINALIZA AO PROGRAMA QUE É A VEZ DO JOGADOR 2 JOGAR. HÁ UMA CONDIÇÃO QUE VERIFICA QUE, SE DI FOR 1, ELE IMPRIME A MENSAGEM REFERENTE À VEZ DO ROBÔ
  PUSH AX
  PUSH DX

  MOV AH,9

  CMP DI,1
  JE OUTRA
  LEA DX,MSG_VEZ_J2
  INT 21h

OUTRA:
  LEA DX,MSG_VEZ_COMP
  INT 21h

  POP DX
  POP AX
ENDM

TENTE_NOVAMENTE MACRO ; MACRO USADA PARA EXIBIR A MENSAGEM DE ENTRADA INVÁLIDA E QUE PEDE AO USUÁRIO UMA NOVA OPÇÃO A SER DIGITADA
  PUSH AX ; EMPILHA OS VALORES ATUAIS DE AX E DE DX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_INVALIDO
  INT 21h

  QUALQUER_TECLA ; EXECUTA A MACRO QUE PEDE A ENTRADA DE QUALQUER TECLA

  TEXTO_INICIO ; EXECUTA A MACRO QUE IMPRIME O TEXTO DE INÍCIO
  PULA_LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA
  PULA_LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA
  CALL IMPRIME_MATRIZ ; EXECUTA O PROCEDIMENTO DE IMPRESSÃO DE MATRIZ
  PULA_LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA
  
  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
  POP AX
ENDM

QUALQUER_TECLA MACRO ; MACRO QUE IMPRIME A MENSAGEM DE ENTRADA DE QUALQUER TECLA E SOLICITA AO USUÁRIO UM NOVO DÍGITO PARA PODER CONTINUAR O FLUXO DO PROGRAMA
  PUSH AX; EMPILHA OS VALORES ATUAIS DE AX E DE DX
  PUSH DX

  PULA_LINHA ; EXECUTA A MACRO QUE EXECUTA O PULO DE LINHA

  MOV AH,9 ; IMPRIME A MENSAGEM MSG_QUALQUER_TECLA ARMAZENADA E DECLARADA EM .DATA
  LEA DX,MSG_QUALQUER_TECLA
  INT 21h

  MOV AH,1 ; FUNÇÃO DE LEITURA DE CARACTERES
  INT 21h

  CLS ; EXECUTA A FUNÇÃO DE LIMPEZA DE TELA

  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
  POP AX
ENDM

 MSG_VIT_1 MACRO ; MACRO QUE IMPRIME A MENSAGEM DE VITÓRIA DO JOGADOR 1
  PUSH AX ; EMPILHA OS VALORES ATUAIS DE AX E DE DX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_VIT_JOG
  INT 21h

  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
  POP AX
 ENDM

 MSG_VIT_2 MACRO ; MACRO QUE IMPRIME A MENSAGEM DE VITÓRIA DO JOGADOR 2
  PUSH AX ; EMPILHA OS VALORES ATUAIS DE AX E DE DX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_VIT_JOG2
  INT 21h

  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
    POP AX
 ENDM

 MSG_VIT_3 MACRO ; MACRO QUE IMPRIME A MENSAGEM DE VITÓRIA DO COMPUTADOR
  PUSH AX ; EMPILHA OS VALORES ATUAIS DE AX E DE DX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_VIT_COMP
  INT 21h

  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
  POP AX
 ENDM

 PERGUNTA_FINAL1 MACRO ; PERGUNTA SE ELE DESEJA JOGAR NOVAMENTE
  MOV AH,9
  LEA DX,MSG_FINAL
  INT 21h

  MOV AH,1
  INT 21h

  CLS

  TEST AL,1
  JNZ JOG_NOV1
 ENDM

 PERGUNTA_FINAL2 MACRO ; PERGUNTA SE ELE DESEJA JOGAR NOVAMENTE
  MOV AH,9
  LEA DX,MSG_FINAL
  INT 21h

  XOR_ALL ; LIMPA TODOS OS REGISTRADORES

  MOV AH,1 ; FUNÇÃO DE CAPTAÇÃO DA ENTRADA DO USUÁRIO
  INT 21h

  CALL RESET_MATRIZ ; EXECUTA O PROCEDIMENTO DE REINICIAR A MATRIZ PARA SEU ESTADO INICIAL

  CLS ; LIMPA A TELA

  TEST AL,1 ; SE O JOGADOR QUISER JOGAR DE NOVO, VOLTE AO INÍCIO DO RÓTULO
  JNZ JOG_NOV2
 ENDM

 XOR_ALL MACRO ; MACRO QUE LIMPARÁ O CONTEÚDO INTERNO AOS REGISTRADORES DE UMA SÓ VEZ
  XOR AX,AX
  XOR BX,BX
  XOR CX,CX
  XOR DX,DX
  XOR SI,SI
ENDM

 ORDE_1 MACRO
  PUSH AX
  PUSH DX

  TEST CX,1 ; SE O NÚMERO DE CASAS RESTANTES A SEREM PREENCHIDAS FOR ÍMPAR, IMPRIMA MSG_VEZ_J1, SENÃO IMPRIMA MSG_VEZ_J2
  JZ JOG2_MSG

  MOV AH,9 ; IMPRIME A MENSAGEM DE VEZ DO JOGADOR 1 E VAI PARA O FIM DA MACRO EM SEGUIDA
  LEA DX,MSG_VEZ_J1
  INT 21h
  JMP FIM_MACRO

JOG2_MSG: ; IMPRIME A MENSAGEM DE VEZ DO JOGADOR 2 E VAI PARA O FIM DA MACRO EM SEGUIDA
  MOV AH,9
  LEA DX,MSG_VEZ_J2
  INT 21h

FIM_MACRO: ; FIM DA MACRO
  POP DX ;DESEMPILHA E ARMAZENA OS VALORES ANTERIORMENTE EMPILHADOS EM DX E AX, RESPECTIVAMENTE
  POP AX
 ENDM

 ORDEM_JOGS2 MACRO
  PUSH AX
  PUSH DX

  TEST CX,1
  JNZ ROBO_MSG

  MOV AH,9
  LEA DX,MSG_VEZ_J1
  INT 21h
  JMP FIM_MACRO

ROBO_MSG:
  MOV AH,9
  LEA DX,MSG_VEZ_ROBO
  INT 21h

FIM_MACRO:
  POP DX
  POP AX
 ENDM

 EMPATE MACRO
  PUSH AX
  PUSH DX

  MOV AH,9
  LEA DX,MSG_EMPATE
  INT 21h

  POP DX
  POP AX
 ENDM
 
 POS_JOGADOR MACRO
  PUSH AX
  PUSH DX

  PULA_LINHA

  MOV AH,9
  LEA DX,MSG_CONTINUA
  INT 21h

  MOV AH,1
  INT 21h

  CLS

  POP DX
  POP AX
ENDM